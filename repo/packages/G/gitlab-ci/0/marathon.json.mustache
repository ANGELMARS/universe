{
  "id": "{{service.name}}",
  "cpus": {{service.cpus}},
  "mem": {{service.mem}},
  "instances": {{service.instances}},
  "env": {
    "GITLAB_SERVICE_NAME" : "{{gitlab.service.name}}",
    "REGISTRATION_TOKEN" : "{{gitlab.service.registration-token}}",
    "RUNNER_EXECUTOR" : "{{gitlab.runner.executor}}",
    "RUNNER_CONCURRENT_BUILDS" : "{{gitlab.runner.concurrent-builds}}"
  },
  "container": {
       "type": "DOCKER",
       "docker": {
           "image": "{{resource.assets.container.docker.gitlab-runner}}",
           "privileged": true,
           "network" : "HOST"
       }
   },
  "healthChecks": [
    {
      "protocol": "COMMAND",
      "command": { "value": "curl --fail ${HOST}:${PORT0}/help > /dev/null" },
      "gracePeriodSeconds": 300,
      "intervalSeconds": 60,
      "timeoutSeconds": 20,
      "maxConsecutiveFailures": 5
    }
  ],
  "labels": {
    "DCOS_SERVICE_NAME": "{{service.name}}"
  }
}
